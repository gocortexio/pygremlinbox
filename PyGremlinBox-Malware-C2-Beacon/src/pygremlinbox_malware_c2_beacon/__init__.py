# SPDX-License-Identifier: GPL-3.0
# SPDX-FileCopyrightText: 2025 PyGremlinBox Maintainer <simon@sigre.xyz>

"""
PyGremlinBox Malware Simulation - Command and Control Beacon.

This package is designed for supply chain security testing and tabletop exercises.
It contains benign code with strategically placed indicator URLs that security
tools should detect. The code itself performs no malicious actions.

This package is licenced under the GNU General Public License v3.0 (GPL-3.0).
"""

__version__ = "1.4.6"
__licence__ = "GPL-3.0"

DETECTION_URLS = [
    "http://urlfiltering.paloaltonetworks.com/test-command-and-control",
    "ws://c2.sigre.xyz:8080/api/ws/notifications",
    "wss://c2.sigre.xyz:8443/ws/phonehome",
    "ws://c2.sigre.xyz:10081/updates/live",
    "wss://c2.sigre.xyz:5577/ws/telemetry/stream",
]


def get_indicators():
    """
    Return C2 beacon indicators for security tool testing.

    Returns:
        list: URLs that security tools should flag as C2 communication
    """
    return DETECTION_URLS.copy()


def get_attack_category():
    """
    Return the attack category for this package.

    Returns:
        str: The attack category identifier
    """
    return "c2_beacon"


def get_package_purpose():
    """
    Return package description for tabletop exercise context.

    Returns:
        str: Description of the package's testing purpose
    """
    return "Supply chain security testing - command and control beacon detection"


def get_package_metadata():
    """
    Return basic metadata about this package.

    Returns:
        dict: Package metadata including name, version, and category
    """
    return {
        "name": "PyGremlinBox-Malware-C2-Beacon",
        "version": __version__,
        "licence": __licence__,
        "category": "c2_beacon",
        "description": "Command and control beacon patterns for security tool testing",
        "indicator_count": len(DETECTION_URLS),
    }


__all__ = [
    "get_indicators",
    "get_attack_category",
    "get_package_purpose",
    "get_package_metadata",
    "DETECTION_URLS",
]
