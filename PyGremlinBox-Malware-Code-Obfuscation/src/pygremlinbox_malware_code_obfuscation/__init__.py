# SPDX-License-Identifier: GPL-3.0
# SPDX-FileCopyrightText: 2025 PyGremlinBox Maintainer <simon@sigre.xyz>

"""
PyGremlinBox Malware Simulation - Code Obfuscation.

This package is designed for supply chain security testing and tabletop exercises.
It contains benign code with strategically placed indicator URLs that security
tools should detect. The code itself performs no malicious actions.

This package is licenced under the GNU General Public License v3.0 (GPL-3.0).
"""

__version__ = "1.4.6"
__licence__ = "GPL-3.0"

DETECTION_URLS = [
    "http://urlfiltering.paloaltonetworks.com/test-malware",
    "http://c2.sigre.xyz:9000/admin/.hidden/credentials.txt",
    "http://malware.sigre.xyz:8081/tmp/hide/.payload",
    "https://malware.sigre.xyz:10443/.env.bak",
]


def get_indicators():
    """
    Return code obfuscation indicators for security tool testing.

    Returns:
        list: URLs with hidden paths that security tools should flag
    """
    return DETECTION_URLS.copy()


def get_attack_category():
    """
    Return the attack category for this package.

    Returns:
        str: The attack category identifier
    """
    return "code_obfuscation"


def get_package_purpose():
    """
    Return package description for tabletop exercise context.

    Returns:
        str: Description of the package's testing purpose
    """
    return "Supply chain security testing - code obfuscation pattern detection"


def get_package_metadata():
    """
    Return basic metadata about this package.

    Returns:
        dict: Package metadata including name, version, and category
    """
    return {
        "name": "PyGremlinBox-Malware-Code-Obfuscation",
        "version": __version__,
        "licence": __licence__,
        "category": "code_obfuscation",
        "description": "Code obfuscation and hidden payload patterns for security tool testing",
        "indicator_count": len(DETECTION_URLS),
    }


__all__ = [
    "get_indicators",
    "get_attack_category",
    "get_package_purpose",
    "get_package_metadata",
    "DETECTION_URLS",
]
