# SPDX-License-Identifier: GPL-3.0
# SPDX-FileCopyrightText: 2025 PyGremlinBox Maintainer <simon@sigre.xyz>

"""
PyGremlinBox Malware Simulation - Cryptomining Indicators.

This package is designed for supply chain security testing and tabletop exercises.
It contains benign code with strategically placed indicator URLs that security
tools should detect. The code itself performs no malicious actions.

This package is licenced under the GNU General Public License v3.0 (GPL-3.0).
"""

__version__ = "1.4.6"
__licence__ = "GPL-3.0"

DETECTION_URLS = [
    "http://urlfiltering.paloaltonetworks.com/test-high-risk",
    "ftp://malware.sigre.xyz:2121/uploads/release_v1.0.tar.gz",
    "ftps://botnet.sigre.xyz:990/secure/pub/financials.xlsx",
    "ftp://botnet.sigre.xyz:51413/incoming/metrics.csv",
]


def get_indicators():
    """
    Return cryptomining indicators for security tool testing.

    Returns:
        list: URLs referencing persistent connections that security tools should flag
    """
    return DETECTION_URLS.copy()


def get_attack_category():
    """
    Return the attack category for this package.

    Returns:
        str: The attack category identifier
    """
    return "cryptomining_indicators"


def get_package_purpose():
    """
    Return package description for tabletop exercise context.

    Returns:
        str: Description of the package's testing purpose
    """
    return "Supply chain security testing - cryptomining indicator detection"


def get_package_metadata():
    """
    Return basic metadata about this package.

    Returns:
        dict: Package metadata including name, version, and category
    """
    return {
        "name": "PyGremlinBox-Malware-Cryptomining-Indicators",
        "version": __version__,
        "licence": __licence__,
        "category": "cryptomining_indicators",
        "description": "Cryptomining and persistent connection patterns for security tool testing",
        "indicator_count": len(DETECTION_URLS),
    }


__all__ = [
    "get_indicators",
    "get_attack_category",
    "get_package_purpose",
    "get_package_metadata",
    "DETECTION_URLS",
]
